<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="transreg">
<title>Penalised regression with multiple sources of prior effects • transreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Penalised regression with multiple sources of prior effects">
<meta property="og:description" content="transreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">transreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">functions</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/analysis.html">analysis</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">news</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Penalised regression with multiple sources of prior effects</h1>
                        <h4 data-toc-skip class="author">Armin
Rauschenberger</h4>
            
            <h4 data-toc-skip class="date">01 December 2022</h4>
      
      
      <div class="d-none name"><code>analysis.Rmd</code></div>
    </div>

    
    
<p><strong>This file contains the code for reproducing the results shown
in the related manuscript (numbers, tables, figures).</strong></p>
<div class="section level2">
<h2 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h2>
<p>Choose the directory containing the sub-directories “data”, “results”
and “manuscript”.</p>
<ul>
<li><p>The directory “data” should contain the file
“pone.0181468.s001.csv” for the second external application and the
files “vcf_with_pvalue.tab” and “LuxPark_pheno.txt” for the internal
application. It will also contain the file “app_int_data.RData” for the
internal application.</p></li>
<li><p>The directory “results” will contain the files “sim_int.RData”
and “sim_ext.RData” for the external and internal simulation, the file
“app_grridge.RData” for the first external application, the file
“app_fwelnet.RData” for the second external application, and the file
“app_int.RData” for the internal application.</p></li>
<li><p>The directory “manuscript” will contain the files “table_int.tex”
and “table_ext.tex” for the internal and external simulations, the file
“figure_example.pdf” for the methods section, the file “figure_ext.pdf”
for the external applications, and the file “figure_int.pdf” for the
internal application.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="st">"~/Desktop/transreg"</span> <span class="co"># physical machine</span></span>
<span><span class="co">#dir &lt;- "/home/armin.rauschenberger/transreg" # virtual machine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"results"</span>,<span class="st">"manuscript"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Missing folders!"</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>eval<span class="op">=</span><span class="cn">TRUE</span>,echo<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Install missing R packages from CRAN and GitHub. Note that
<code>ecpc</code> is and <code>transreg</code> will also be available on
CRAN. For package versions, see session information at the end of this
document and in the text files associated with each R data file.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"devtools"</span>,<span class="st">"palasso"</span>,<span class="st">"glmtrans"</span>,<span class="st">"xtable"</span><span class="op">)</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">pkgs</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kjytay/fwelnet"</span>,<span class="st">"Mirrelijn/ecpc/Rpackage"</span>,<span class="st">"rauschenberger/transreg"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span></span>
<span><span class="co">#remotes::install_gitlab("bds/transreg",host="gitlab.lcsb.uni.lu")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>The following chunk generates the figure for the methods section.</p>
<ul>
<li><p>input: none (<em>simulating data</em>)</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/figure_example.pdf</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/figure_example.pdf"</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">8</span>,height<span class="op">=</span><span class="fl">5</span>,pointsize<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>; <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">range</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span>p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">[</span><span class="va">temp</span><span class="op">&lt;</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">[</span><span class="va">temp</span><span class="op">&gt;</span><span class="va">range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">ident</span> <span class="op">&lt;-</span> <span class="va">temp</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">temp</span><span class="op">&lt;=</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">temp</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">temp</span><span class="op">&lt;=</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">beta</span><span class="op">$</span><span class="va">combn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">temp</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">temp</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>,mean<span class="op">=</span><span class="va">eta</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/calibrate.html">.exp.multiple</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,prior<span class="op">=</span><span class="va">prior</span>,family<span class="op">=</span><span class="st">"gaussian"</span>,select<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/calibrate.html">.iso.fast.single</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,prior<span class="op">=</span><span class="va">prior</span>,family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">prior</span>,<span class="op">-</span><span class="va">prior</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">beta</span>,<span class="va">b</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>,ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span>,line<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prior</span>,y<span class="op">=</span><span class="va">a</span><span class="op">$</span><span class="va">beta</span>,col<span class="op">=</span><span class="st">"red"</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prior</span>,y<span class="op">=</span><span class="va">b</span><span class="op">$</span><span class="va">beta</span>,col<span class="op">=</span><span class="st">"blue"</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prior</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">prior</span><span class="op">)</span><span class="op">]</span>,y<span class="op">=</span><span class="va">beta</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">prior</span><span class="op">)</span><span class="op">]</span>,lwd<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topleft"</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"("</span>,<span class="va">i</span>,<span class="st">")"</span><span class="op">)</span>,bty<span class="op">=</span><span class="st">"n"</span>,x.intersp<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<p>The following chunk performs the external (<code>glmtrans</code>) and
the internal simulation.</p>
<ul>
<li><p>input: none (<em>simulating data</em>)</p></li>
<li><p>execution time: <strong>several minutes</strong></p></li>
<li><p>output: results/sim_ext.RData, results/sim_int.RData,
results/info_sim.RData</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - - - modify glmtrans::models function - - -</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>glmtrans.models <span class="ot">&lt;-</span> glmtrans<span class="sc">::</span>models</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">deparse</span>(glmtrans.models)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># return target beta</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern=</span><span class="st">"list</span><span class="sc">\\</span><span class="st">(x </span><span class="sc">\\</span><span class="st">= NULL, y </span><span class="sc">\\</span><span class="st">= NULL</span><span class="sc">\\</span><span class="st">)"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">replacement=</span><span class="st">"list(x = NULL, y = NULL, beta = wk)"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">x=</span>string)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># return source beta</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern=</span><span class="st">"list</span><span class="sc">\\</span><span class="st">(x </span><span class="sc">\\</span><span class="st">= x, y </span><span class="sc">\\</span><span class="st">= y</span><span class="sc">\\</span><span class="st">)"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">replacement=</span><span class="st">"list(x = x, y = y, beta = wk)"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">x=</span>string)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>glmtrans.models <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span>string))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(string)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - - - - - - - - - - - - - - - - - - - - - -</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(mode <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"ext"</span>,<span class="st">"int"</span>)){</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulation setting</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(mode<span class="sc">==</span><span class="st">"ext"</span>){</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>      frame <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Ka=</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)),</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">K=</span><span class="fu">as.integer</span>(<span class="dv">5</span>),</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">h=</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">250</span>)),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha=</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family=</span><span class="fu">c</span>(<span class="st">"gaussian"</span>,<span class="st">"binomial"</span>))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>      frame<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">each=</span><span class="dv">6</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(mode<span class="sc">==</span><span class="st">"int"</span>){</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>      frame <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">rho.x=</span><span class="fu">c</span>(<span class="fl">0.95</span>,<span class="fl">0.99</span>),</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rho.beta=</span><span class="fu">c</span>(<span class="fl">0.70</span>,<span class="fl">0.85</span>,<span class="fl">0.99</span>),</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha=</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family=</span><span class="fu">c</span>(<span class="st">"gaussian"</span>,<span class="st">"binomial"</span>))</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      frame<span class="sc">$</span>seed <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    frame<span class="sc">$</span>family <span class="ot">&lt;-</span> <span class="fu">as.character</span>(frame<span class="sc">$</span>family)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    frame[,<span class="fu">c</span>(<span class="st">"cor.x"</span>,<span class="st">"cor.beta"</span>,<span class="st">"mean"</span>,<span class="st">"glmnet"</span>,<span class="st">"glmtrans"</span>,<span class="st">"transreg"</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1000</span>; n0 <span class="ot">&lt;-</span> <span class="dv">100</span>; n1 <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    n.target <span class="ot">&lt;-</span> n0<span class="sc">+</span>n1</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    foldid.ext <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">times=</span><span class="fu">c</span>(n0,n1))</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(iter <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(frame))){</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(frame<span class="sc">$</span>seed[iter])){<span class="fu">set.seed</span>(frame<span class="sc">$</span>seed[iter])}</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#alpha &lt;- frame$alpha[iter] </span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#family &lt;- as.character(frame$family[iter])</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>      <span class="co">#rho.beta &lt;- frame$rho.beta[iter]</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>      <span class="co"># data simulation</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(mode<span class="sc">==</span><span class="st">"ext"</span>){ </span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">message</span>(<span class="st">"Using external simulation study!"</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(frame<span class="sc">$</span>alpha[iter]<span class="sc">==</span><span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">15</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        data <span class="ot">&lt;-</span> <span class="fu">glmtrans.models</span>(<span class="at">family=</span>frame<span class="sc">$</span>family[iter],<span class="at">type=</span><span class="st">"all"</span>,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>                                <span class="at">p=</span>p,<span class="at">n.target=</span>n.target,<span class="at">s=</span>s,</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Ka=</span>frame<span class="sc">$</span>Ka[iter],<span class="at">K=</span>frame<span class="sc">$</span>K[iter],<span class="at">h=</span>frame<span class="sc">$</span>h[iter])</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>        target <span class="ot">&lt;-</span> data<span class="sc">$</span>target</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>        source <span class="ot">&lt;-</span> data<span class="sc">$</span>source</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">sapply</span>(data<span class="sc">$</span>source,<span class="cf">function</span>(x) x<span class="sc">$</span>beta),data<span class="sc">$</span>target<span class="sc">$</span>beta)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span>(mode<span class="sc">==</span><span class="st">"int"</span>){</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">message</span>(<span class="st">"Using internal simulation study!"</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>        prop <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(frame<span class="sc">$</span>alpha[iter]<span class="sc">==</span><span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.05</span>)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        data <span class="ot">&lt;-</span> transreg<span class="sc">:::</span><span class="fu">simulate</span>(<span class="at">p=</span>p,<span class="at">n.target=</span>n.target,<span class="at">family=</span>frame<span class="sc">$</span>family[iter],</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prop=</span>prop,<span class="at">rho.beta=</span>frame<span class="sc">$</span>rho.beta[iter],<span class="at">w=</span><span class="fl">0.5</span>,</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rho.x=</span>frame<span class="sc">$</span>rho.x[iter],<span class="at">k=</span><span class="dv">3</span>,<span class="at">exp=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">0.5</span>),</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>                                <span class="at">trans=</span><span class="fu">c</span>(<span class="cn">FALSE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>        target <span class="ot">&lt;-</span> data<span class="sc">$</span>target</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>        source <span class="ot">&lt;-</span> data<span class="sc">$</span>source</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">&lt;-</span> data<span class="sc">$</span>beta</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># correlation</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> <span class="fu">abs</span>(stats<span class="sc">::</span><span class="fu">cor</span>(data<span class="sc">$</span>target<span class="sc">$</span>x,<span class="at">method=</span><span class="st">"pearson"</span>))</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>      temp[<span class="fu">lower.tri</span>(temp,<span class="at">diag=</span><span class="cn">TRUE</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>      frame<span class="sc">$</span>cor.x[iter] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">&lt;-</span> <span class="fu">abs</span>(stats<span class="sc">::</span><span class="fu">cor</span>(beta,<span class="at">method=</span><span class="st">"pearson"</span>))</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>      temp[<span class="fu">lower.tri</span>(temp,<span class="at">diag=</span><span class="cn">TRUE</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>      frame<span class="sc">$</span>cor.beta[iter] <span class="ot">&lt;-</span> <span class="fu">max</span>(temp[,<span class="fu">ncol</span>(temp)],<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>      <span class="co"># predictive performance</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>      loss <span class="ot">&lt;-</span> transreg<span class="sc">:::</span><span class="fu">compare</span>(<span class="at">target=</span>target,<span class="at">source=</span>source,</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family=</span>frame<span class="sc">$</span>family[iter],<span class="at">alpha=</span>frame<span class="sc">$</span>alpha[iter],</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>                          <span class="at">foldid.ext=</span>foldid.ext,<span class="at">nfolds.ext=</span><span class="dv">1</span>,</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>                          <span class="at">scale=</span><span class="fu">c</span>(<span class="st">"exp"</span>,<span class="st">"iso"</span>),</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sign=</span><span class="cn">FALSE</span>,<span class="at">switch=</span><span class="cn">FALSE</span>,<span class="at">select=</span><span class="cn">TRUE</span>,<span class="at">alpha.prior=</span><span class="cn">NULL</span>,</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>                          <span class="at">seed=</span>frame<span class="sc">$</span>seed[iter])</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>      frame[iter,<span class="fu">names</span>(loss<span class="sc">$</span>deviance)] <span class="ot">&lt;-</span> loss<span class="sc">$</span>deviance</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">save</span>(frame,<span class="at">file=</span><span class="fu">paste0</span>(dir,<span class="st">"/results/sim_"</span>,mode,<span class="st">".RData"</span>))<span class="er">)</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="at">text=</span><span class="fu">capture.output</span>(utils<span class="sc">::</span><span class="fu">sessionInfo</span>(),<span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>      sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()),<span class="at">con=</span><span class="fu">paste0</span>(dir,<span class="st">"/results/info_sim.txt"</span>))</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="co">#colMeans(frame[,paste0("transreg.",c("exp","iso"),".sta")],na.rm=TRUE)</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a><span class="co">#colMeans(frame[,paste0("transreg.",c("exp","iso"),".sim")],na.rm=TRUE)</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a><span class="co">#stats::wilcox.test(x=frame$glmtrans,y=frame$transreg,alternative="greater")</span></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a><span class="co">#load("results/sim_int.RData")</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a><span class="co">#load("results/sim_ext.RData")</span></span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- frame[c("mean","glmnet","glmtrans","stage","transreg")]/frame$mean</span></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="co">#cbind(frame$family,frame$alpha,frame$K,round(100*data,digits=0))</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a><span class="co">#colMeans(data)</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a><span class="co">#apply(data,2,median)</span></span></code></pre></div>
<p>The following chunk generates the tables for the external
(<code>glmtrans</code>) and the internal simulation. <strong>Requires
execution of previous chunk.</strong></p>
<ul>
<li><p>input: results/sim_ext.RData, results/sim_int.RData</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/table_ext.tex,
manuscript/table_int.tex</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">loss</span>,<span class="va">info</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">hline</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">pvalue</span><span class="op">=</span><span class="cn">NULL</span>,<span class="va">caption</span><span class="op">=</span><span class="st">""</span>,<span class="va">file</span><span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">Inf</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">quote</span> <span class="op">&lt;-</span> <span class="cn">NA</span><span class="op">*</span><span class="va">loss</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">4</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">quote</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|</span> </span>
<span>      <span class="op">(</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span> <span class="va">loss</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">quote</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&amp;</span></span>
<span>          <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&amp;</span></span>
<span>          <span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span>,<span class="op">]</span><span class="op">==</span><span class="va">loss</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">quote</span><span class="op">)</span><span class="op">-</span><span class="fl">3</span>,<span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loss</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>   </span>
<span>  <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="fl">1</span>,<span class="va">which.min</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">pos</span> <span class="op">&lt;-</span> <span class="va">loss</span> <span class="op">&gt;=</span> <span class="fl">0</span></span>
<span>  <span class="va">leq</span> <span class="op">&lt;-</span> <span class="va">loss</span> <span class="op">&gt;=</span> <span class="va">loss</span><span class="op">[</span>,<span class="st">"glmnet"</span><span class="op">]</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loss</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span><span class="va">loss</span><span class="op">[</span><span class="va">quote</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"\""</span><span class="op">}</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">leq</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\textcolor{gray}{"</span>,<span class="va">loss</span><span class="op">[</span><span class="va">leq</span><span class="op">]</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">min</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\underline{"</span>,<span class="va">loss</span><span class="op">[</span><span class="va">min</span><span class="op">]</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  <span class="va">loss</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="va">loss</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\texttt{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"\\textsc{"</span>,<span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">table</span> <span class="op">&lt;-</span> <span class="va">loss</span></span>
<span>    <span class="va">align</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"|r|"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"r"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span><span class="op">)</span></span>
<span>    <span class="va">include.rownames</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">info</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"-"</span></span>
<span>    <span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">info</span>,<span class="va">loss</span><span class="op">)</span></span>
<span>    <span class="va">align</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"|r|"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"r"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"r"</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,<span class="st">"|"</span><span class="op">)</span></span>
<span>    <span class="va">include.rownames</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">xtable</span> <span class="op">&lt;-</span> <span class="fu">xtable</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/xtable.html" class="external-link">xtable</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">table</span>,caption<span class="op">=</span><span class="va">caption</span>,align<span class="op">=</span><span class="va">align</span><span class="op">)</span></span>
<span>  <span class="fu">xtable</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xtable/man/print.xtable.html" class="external-link">print.xtable</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">xtable</span>,</span>
<span>                       sanitize.text.function<span class="op">=</span><span class="va">identity</span>,</span>
<span>                       include.rownames<span class="op">=</span><span class="va">include.rownames</span>,</span>
<span>                       floating<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                       comment<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                       hline.after<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="va">hline</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       caption.placement<span class="op">=</span><span class="st">"top"</span>,</span>
<span>                       file<span class="op">=</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">mode</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ext"</span>,<span class="st">"int"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/sim_"</span>,<span class="va">mode</span>,<span class="st">".RData"</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Missing file "</span>,<span class="va">file</span>,<span class="st">"."</span><span class="op">)</span>;<span class="kw">next</span><span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span>    <span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ka"</span>,<span class="st">"h"</span>,<span class="st">"rho.x"</span>,<span class="st">"rho.beta"</span>,<span class="st">"cor.x"</span>,<span class="st">"cor.beta"</span>,<span class="st">"cor.t"</span>,<span class="st">"alpha"</span>,<span class="st">"family"</span><span class="op">)</span></span>
<span>    <span class="va">info</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span>,<span class="va">cond</span><span class="op">]</span></span>
<span>    <span class="va">info</span> <span class="op">&lt;-</span> <span class="va">info</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"transreg."</span>,replacement<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co">#colnames(frame) &lt;- gsub(pattern="_",replacement=".",x=colnames(frame))</span></span>
<span>    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>,<span class="st">"glmnet"</span>,<span class="st">"glmtrans"</span>,<span class="st">"exp.sta"</span>,<span class="st">"exp.sim"</span>,<span class="st">"iso.sta"</span>,<span class="st">"iso.sim"</span><span class="op">)</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span>,<span class="va">names</span><span class="op">]</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">loss</span><span class="op">/</span><span class="va">loss</span><span class="op">$</span><span class="va">mean</span>,digits<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">loss</span><span class="op">[</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"mean"</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">info</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"Ka"</span><span class="op">=</span><span class="st">"$K_a$"</span>,<span class="st">"K"</span><span class="op">=</span><span class="st">"$K$"</span>,<span class="st">"h"</span><span class="op">=</span><span class="st">"$h$"</span>,<span class="st">"alpha"</span><span class="op">=</span><span class="st">"$\\alpha$"</span>,<span class="st">"rho.x"</span><span class="op">=</span><span class="st">"$\\rho_x$"</span>,<span class="st">"rho.beta"</span><span class="op">=</span><span class="st">"$\\rho_\\beta$"</span>,<span class="st">"cor.x"</span><span class="op">=</span><span class="st">"$\\bar{\\rho}_{x}$"</span>,<span class="st">"cor.beta"</span><span class="op">=</span><span class="st">"$\\max(\\hat{\\rho}_{\\beta})$"</span>,<span class="st">"cor.t"</span><span class="op">=</span><span class="st">"$\\bar{\\rho}_{a}$"</span>,<span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">external</span> <span class="op">&lt;-</span> <span class="st">"number of transferable source data sets ($K_a$), differences between source and target coefficients ($h$), dense setting with ridge regularisation ($s=50$, $\\alpha=0$) or sparse setting with lasso regularisation ($s=15$, $\\alpha=1$), family of distribution (`gaussian' or `binomial')."</span></span>
<span>    <span class="va">internal</span> <span class="op">&lt;-</span> <span class="st">"correlation parameter for features ($\\rho_x$), correlation parameter for coefficients ($\\rho_{\\beta}$), dense setting with ridge regularisation ($\\pi=20\\%$, $\\alpha=0$) or sparse setting with lasso regularisation ($\\pi=5\\%$, $\\alpha=1$), family of distribution (`gaussian' or `binomial')."</span></span>
<span>    <span class="va">caption</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Testing loss in "</span>,<span class="va">mode</span>,<span class="st">"ernal simulation, as a percentage of the one from prediction by the mean. Settings: "</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"ext"</span>,<span class="va">external</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mode</span><span class="op">==</span><span class="st">"int"</span>,<span class="va">internal</span>,<span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>,<span class="st">" These parameters determine (i) the average Pearson correlations among the features in the target data set ($\\bar{\\rho}_x$) and (ii) the maximum Pearson correlation between the coefficients in the target data set and the coefficients in the source data sets ($\\max(\\hat{\\rho}_{\\beta})$). Methods: regularised regression (\\texttt{glmnet}), competing transfer learning method (\\texttt{glmtrans}), proposed transfer learning method (\\texttt{transreg}) with exponential/isotonic calibration and standard/simultaneous stacking. In each setting, the colour black highlights methods that are more predictive than regularised regression without transfer learning (\\texttt{glmnet}), and an underline highlights the most predictive method. \\label{sim_"</span>,<span class="va">mode</span>,<span class="st">"}"</span><span class="op">)</span></span>
<span>    <span class="fu">.table</span><span class="op">(</span>info<span class="op">=</span><span class="va">info</span>,loss<span class="op">=</span><span class="va">loss</span>,caption<span class="op">=</span><span class="va">caption</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/table_"</span>,<span class="va">mode</span>,<span class="st">".tex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="external-applications">External applications<a class="anchor" aria-label="anchor" href="#external-applications"></a>
</h2>
<p>The following chunk performs the first external application
(<code>GRridge</code>).</p>
<ul>
<li><p>input: none (<em>loading data from <code>GRridge</code>
package</em>)</p></li>
<li><p>execution time: <strong>several minutes</strong></p></li>
<li><p>output: results/app_grridge.RData,
results/info_app_grridge.txt</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataVerlaat</span>,package<span class="op">=</span><span class="st">"GRridge"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">target</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">respVerlaat</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">target</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">datcenVerlaat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pvalFarkas</span><span class="op">)</span> <span class="co"># ecpc and fwelnet</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">diffmeanFarkas</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pvalFarkas</span><span class="op">)</span><span class="op">)</span> <span class="co"># transreg</span></span>
<span></span>
<span><span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"---"</span>,<span class="va">i</span>,<span class="st">"---\n"</span><span class="op">)</span></span>
<span>  <span class="va">loss</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span>target<span class="op">=</span><span class="va">target</span>,prior<span class="op">=</span><span class="va">prior</span>,z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">z</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="fl">0</span>,scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span>,sign<span class="op">=</span><span class="cn">FALSE</span>,switch<span class="op">=</span><span class="cn">FALSE</span>,select<span class="op">=</span><span class="cn">FALSE</span>,monotone<span class="op">=</span><span class="cn">NULL</span>,partitions<span class="op">=</span><span class="cn">NULL</span>,type.measure<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>,<span class="st">"class"</span>,<span class="st">"auc"</span><span class="op">)</span>,seed<span class="op">=</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">loss</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_grridge.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span>,</span>
<span>      <span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,con<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/info_app_grridge.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_grridge.RData"</span><span class="op">)</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">table</span><span class="op">-</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">/</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glmnet"</span>,<span class="st">"transreg.exp.sta"</span>,<span class="st">"transreg.exp.sim"</span>,<span class="st">"transreg.iso.sta"</span>,<span class="st">"transreg.iso.sim"</span>,<span class="st">"fwelnet"</span>,<span class="st">"ecpc"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The following chunk performs the second external application
(<code>fwelnet</code>).</p>
<ul>
<li><p>input: data/pone.0181468.s001.csv</p></li>
<li><p>execution time: <strong>several minutes</strong></p></li>
<li><p>output: results/app_fwelnet.RData,
results/info_app_fwelnet.txt</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data/pone.0181468.s001.csv"</span>,header<span class="op">=</span><span class="cn">TRUE</span>,skip<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">extract</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cond</span>,<span class="va">y</span>,<span class="va">X</span>,<span class="va">id</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cond</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">!=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Invalid input."</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">id</span>,<span class="va">cond</span><span class="op">)</span><span class="op">[</span>,<span class="st">"TRUE"</span><span class="op">]</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">cond</span>,<span class="op">]</span></span>
<span>  <span class="va">id</span> <span class="op">&lt;-</span> <span class="va">id</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span>  <span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span>,times<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="va">ys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ids</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">id</span><span class="op">==</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span><span class="op">[</span><span class="va">ys</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ys</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span><span class="op">[</span><span class="va">ys</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ys</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">foldid</span>,times<span class="op">=</span><span class="va">n</span><span class="op">[</span><span class="va">n</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">foldid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">!=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Invalid output."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,x<span class="op">=</span><span class="va">X</span>,weights<span class="op">=</span><span class="va">weights</span>,foldid<span class="op">=</span><span class="va">foldid</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">loss</span> <span class="op">&lt;-</span> <span class="va">ridge</span> <span class="op">&lt;-</span> <span class="va">lasso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"---"</span>,<span class="va">i</span>,<span class="st">"---\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">$</span><span class="va">LatePE</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"SL"</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">limit</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span>  <span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>,size<span class="op">=</span><span class="fl">1</span>,prob<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="va">source.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span><span class="op">==</span><span class="fl">0</span> <span class="op">|</span> <span class="va">min</span> <span class="op">&gt;</span> <span class="va">limit</span><span class="op">)</span></span>
<span>  <span class="va">target.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">min</span> <span class="op">&lt;=</span> <span class="va">limit</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">source.id</span>,<span class="va">target.id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">source.id</span>,<span class="va">target.id</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">source.id</span>,<span class="va">target.id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">source</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract.html">extract</a></span><span class="op">(</span>cond<span class="op">=</span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">source.id</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">&lt;=</span><span class="va">limit</span><span class="op">)</span>,y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,id<span class="op">=</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span>  <span class="va">source</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract.html">extract</a></span><span class="op">(</span>cond<span class="op">=</span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">source.id</span><span class="op">)</span>,y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,id<span class="op">=</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">prior</span> <span class="op">&lt;-</span> <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">source</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">base</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span>,x<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>,</span>
<span>                              family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="fl">0</span>,</span>
<span>                              weights<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">weights</span>,</span>
<span>                              foldid<span class="op">=</span><span class="va">source</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">foldid</span><span class="op">)</span></span>
<span>    <span class="va">prior</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">base</span>,s<span class="op">=</span><span class="st">"lambda.min"</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">z</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">base</span>,s<span class="op">=</span><span class="st">"lambda.min"</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">target</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">target.id</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">target</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">target.id</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="va">X</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span> <span class="op">&amp;</span> <span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">GA</span><span class="op">[</span><span class="va">table</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">loss</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span>target<span class="op">=</span><span class="va">target</span>,prior<span class="op">=</span><span class="va">prior</span>,family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="fl">0</span>,scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span>,sign<span class="op">=</span><span class="cn">FALSE</span>,switch<span class="op">=</span><span class="cn">FALSE</span>,select<span class="op">=</span><span class="cn">FALSE</span>,z<span class="op">=</span><span class="va">z</span>,type.measure<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>,<span class="st">"class"</span>,<span class="st">"auc"</span><span class="op">)</span>,seed<span class="op">=</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">loss</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_fwelnet.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span>,</span>
<span>      <span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,con<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/info_app_fwelnet.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_fwelnet.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">table</span><span class="op">-</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">/</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glmnet"</span>,<span class="st">"transreg.exp.sta"</span>,<span class="st">"transreg.exp.sim"</span>,<span class="st">"transreg.iso.sta"</span>,<span class="st">"transreg.iso.sim"</span>,<span class="st">"fwelnet"</span>,<span class="st">"ecpc"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="va">table</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">table</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The following chunk generates the figure for both external
applications (<code>GRridge</code> and <code>fwelnet</code>).
<strong>Requires execution of previous two chunks.</strong></p>
<ul>
<li><p>input: results/app_grridge.RData,
results/app_fwelnet.RData</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/figure_ext.pdf</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/figure_ext.pdf"</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">8</span>,height<span class="op">=</span><span class="fl">6</span>,pointsize<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grridge"</span>,<span class="st">"fwelnet"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_"</span>,<span class="va">k</span>,<span class="st">".RData"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span>;<span class="kw">next</span><span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">deviance</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"transreg."</span>,replacement<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">loss</span> <span class="op">&lt;-</span> <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="va">loss</span><span class="op">-</span><span class="va">loss</span><span class="op">$</span><span class="va">glmnet</span><span class="op">)</span><span class="op">/</span><span class="va">loss</span><span class="op">$</span><span class="va">glmnet</span></span>
<span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp.sta"</span>,<span class="st">"exp.sim"</span>,<span class="st">"iso.sta"</span>,<span class="st">"iso.sim"</span><span class="op">)</span></span>
<span>  <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fwelnet"</span>,<span class="st">"ecpc"</span>,<span class="va">temp</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">+</span><span class="fl">0.5</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loss</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,labels<span class="op">=</span><span class="va">name</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"grridge"</span>,x<span class="op">=</span><span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">10</span>,to<span class="op">=</span><span class="fl">10</span>,by<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"fwelnet"</span>,x<span class="op">=</span><span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">20</span>,to<span class="op">=</span><span class="fl">20</span>,by<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">at</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"0%"</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">at</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">at</span>,<span class="st">"%"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"+"</span>,<span class="va">at</span>,<span class="st">"%"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span>,at<span class="op">=</span><span class="va">at</span>,labels<span class="op">=</span><span class="va">labels</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>ylab<span class="op">=</span><span class="st">"change in loss"</span>,line<span class="op">=</span><span class="fl">2.5</span>,cex.lab<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">palasso</span><span class="fu">:::</span><span class="fu">.boxplot</span><span class="op">(</span><span class="va">loss</span><span class="op">[</span>,<span class="va">name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,at<span class="op">=</span><span class="va">i</span>,invert<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">loss</span><span class="op">[</span>,<span class="va">name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">22</span>,col<span class="op">=</span><span class="st">"white"</span>,bg<span class="op">=</span><span class="st">"black"</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="internal-application">Internal application<a class="anchor" aria-label="anchor" href="#internal-application"></a>
</h2>
<p>The following chunk performs the internal application.</p>
<ul>
<li><p>input: data/vcf_with_pvalue.tab, data/LuxPark_pheno.txt</p></li>
<li><p>execution time: <strong>two days</strong> (unless parallel
computing)</p></li>
<li><p>output: data/app_int_data.RData, results/app_int.RData,
results/info_app_int.txt</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span><span class="va">geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/vcf_with_pvalue.tab"</span><span class="op">)</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">switch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">REF</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A1_gwas</span> <span class="op">&amp;</span> <span class="va">geno</span><span class="op">$</span><span class="va">ALT</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A2_gwas</span>,<span class="fl">1</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">REF</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A2_gwas</span> <span class="op">&amp;</span> <span class="va">geno</span><span class="op">$</span><span class="va">ALT</span><span class="op">==</span><span class="va">geno</span><span class="op">$</span><span class="va">A1_gwas</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#prior &lt;- -geno$beta*switch # original effect sizes</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">p_value</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">geno</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">*</span><span class="va">switch</span> <span class="co"># pseudo effect sizes</span></span>
<span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">geno</span><span class="op">$</span><span class="va">p_value</span></span>
<span></span>
<span><span class="co"># Note: Why are pseudo-effect sizes more suitable as prior effects as compared to original effect sizes?</span></span>
<span><span class="co"># graphics::plot(x=geno$beta,y=-log10(geno$p_value),xlim=c(-1,1),col=ifelse(stats::p.adjust(geno$p_value)&lt;=0.05,"red","black"))</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">geno</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"ND"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">geno</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">X</span><span class="op">==</span><span class="st">"0/0"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">X</span><span class="op">==</span><span class="st">"0/1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="va">X</span><span class="op">==</span><span class="st">"1/1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">as.numeric</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/LuxPark_pheno.txt"</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">" "</span>,header<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">$</span><span class="va">V2</span><span class="op">==</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">$</span><span class="va">V2</span><span class="op">==</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pheno</span><span class="op">$</span><span class="va">V1</span></span>
<span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">names</span>,<span class="op">]</span>; <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">names</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Note: Are prior effects positively correlated with correlation between outcome and features?</span></span>
<span><span class="co"># cor &lt;- as.numeric(stats::cor(y,X,method="spearman"))</span></span>
<span><span class="co"># graphics::plot(x=prior,y=cor,col=ifelse(stats::p.adjust(geno$p_value)&lt;=0.05,"red","black"))</span></span>
<span><span class="co"># graphics::abline(h=0,lty=2,col="grey")</span></span>
<span></span>
<span><span class="co"># descriptive statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">pvalue</span>,method<span class="op">=</span><span class="st">"BH"</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">pvalue</span>,method<span class="op">=</span><span class="st">"holm"</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pvalue</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># memory reduction</span></span>
<span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="va">pvalue</span> <span class="op">&lt;=</span> <span class="fl">0.05</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>,<span class="va">cond</span><span class="op">]</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="va">prior</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">pvalue</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span><span class="va">switch</span> <span class="op">&lt;-</span> <span class="va">switch</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">X</span>,<span class="va">prior</span>,<span class="va">pvalue</span>,<span class="va">switch</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/app_int_data.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/app_int_data.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">2</span>,to<span class="op">=</span><span class="op">-</span><span class="fl">10</span>,by<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">5</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="va">power</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="va">cutoff</span>,alpha<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,count<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- - - sequential (start) - - -</span></span>
<span><span class="co">#loss &lt;- list()</span></span>
<span><span class="co">#for(i in seq_len(nrow(frame))){</span></span>
<span><span class="co">#  cat("--- i =",i,"---","\n")</span></span>
<span><span class="co">#  set.seed(frame$seed[i])</span></span>
<span><span class="co">#  foldid &lt;- transreg:::.folds(y=y,nfolds.ext=10,nfolds.int=10)</span></span>
<span><span class="co">#  cond &lt;- switch!=0 &amp; pvalue &lt; frame$cutoff[i]</span></span>
<span><span class="co">#  loss[[i]] &lt;- transreg:::compare(target=list(y=y,x=X[,cond]),prior=prior[cond],family="binomial",alpha=frame$alpha[i],scale=c("exp","iso"),sign=FALSE,switch=FALSE,select=FALSE,foldid.ext=foldid$foldid.ext,foldid.int=foldid$foldid.int,type.measure=c("deviance","class","auc"),seed=frame$seed[i])</span></span>
<span><span class="co">#  frame$count[i] &lt;- sum(cond)</span></span>
<span><span class="co">#}</span></span>
<span><span class="co"># - - - sequential (end) - - -</span></span>
<span></span>
<span><span class="co">#- - - parallel (start) - - -</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="va">cutoff</span>,alpha<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,count<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu">snow</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/snow/man/snow-startstop.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">evaluate</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">frame</span>,<span class="va">i</span>,<span class="va">switch</span>,<span class="va">pvalue</span>,<span class="va">y</span>,<span class="va">X</span>,<span class="va">prior</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">seed</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">foldid</span> <span class="op">&lt;-</span> <span class="fu">transreg</span><span class="fu">:::</span><span class="fu">.folds</span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,nfolds.ext<span class="op">=</span><span class="fl">10</span>,nfolds.int<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">cond</span> <span class="op">&lt;-</span> <span class="va">switch</span><span class="op">!=</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">pvalue</span> <span class="op">&lt;</span> <span class="va">frame</span><span class="op">$</span><span class="va">cutoff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu">transreg</span><span class="fu">:::</span><span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span>target<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,x<span class="op">=</span><span class="va">X</span><span class="op">[</span>,<span class="va">cond</span><span class="op">]</span><span class="op">)</span>,prior<span class="op">=</span><span class="va">prior</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span>,family<span class="op">=</span><span class="st">"binomial"</span>,alpha<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,scale<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span>,sign<span class="op">=</span><span class="cn">FALSE</span>,switch<span class="op">=</span><span class="cn">FALSE</span>,select<span class="op">=</span><span class="cn">FALSE</span>,foldid.ext<span class="op">=</span><span class="va">foldid</span><span class="op">$</span><span class="va">foldid.ext</span>,foldid.int<span class="op">=</span><span class="va">foldid</span><span class="op">$</span><span class="va">foldid.int</span>,type.measure<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>,<span class="st">"class"</span>,<span class="st">"auc"</span><span class="op">)</span>,seed<span class="op">=</span><span class="va">frame</span><span class="op">$</span><span class="va">seed</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">snow</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/snow/man/snow-cluster.html" class="external-link">clusterExport</a></span><span class="op">(</span>cl<span class="op">=</span><span class="va">cluster</span>,list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"evaluate"</span>,<span class="st">"frame"</span>,<span class="st">"switch"</span>,<span class="st">"pvalue"</span>,<span class="st">"y"</span>,<span class="st">"X"</span>,<span class="st">"prior"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu">snow</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/snow/man/snow-parallel.html" class="external-link">parSapply</a></span><span class="op">(</span>cl<span class="op">=</span><span class="va">cluster</span>,X<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">evaluate</span><span class="op">(</span>frame<span class="op">=</span><span class="va">frame</span>,i<span class="op">=</span><span class="va">i</span>,switch<span class="op">=</span><span class="va">switch</span>,pvalue<span class="op">=</span><span class="va">pvalue</span>,y<span class="op">=</span><span class="va">y</span>,X<span class="op">=</span><span class="va">X</span>,prior<span class="op">=</span><span class="va">prior</span><span class="op">)</span>,simplify<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#- - - parallel (end) - - -</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">frame</span>,<span class="va">loss</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_int.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span>,</span>
<span>      <span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,con<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/info_app_int.txt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following chunk generates the figures for the internal
application. <strong>Requires execution of previous chunk.</strong></p>
<ul>
<li><p>input: results/app_int.RData</p></li>
<li><p>execution time: some seconds</p></li>
<li><p>output: manuscript/figure_int.pdf,
manuscript/figure_temp.pdf</p></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&lt;&lt;init&gt;&gt;</span></span>
<span></span>
<span><span class="va">plotter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span>,<span class="va">cutoff</span>,<span class="va">number</span>,<span class="va">horizontal</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1.8</span>,<span class="fl">1.0</span>,<span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">scale</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>,<span class="st">"iso"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">alpha</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>,<span class="st">"1"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"ridge"</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"lasso"</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,<span class="st">"-"</span>,<span class="va">scale</span><span class="op">)</span>,cex.main<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span>
<span>      <span class="va">on</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>,length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">on</span><span class="op">)</span><span class="op">)</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">)</span><span class="op">[</span><span class="va">on</span><span class="op">]</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">cutoff</span><span class="op">[</span><span class="va">on</span><span class="op">]</span>,<span class="st">"\n"</span>,<span class="st">"("</span>,<span class="va">number</span><span class="op">[</span><span class="va">on</span><span class="op">]</span>,<span class="st">")"</span><span class="op">)</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>      <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side<span class="op">=</span><span class="fl">2</span>,cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">horizontal</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.5</span>,col<span class="op">=</span><span class="st">"grey"</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>        <span class="co">#graphics::abline(h=unique(table[["mean"]][,alpha]),col="grey",lty=2)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">method</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glmnet"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"transreg."</span>,<span class="va">scale</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".sta"</span>,<span class="st">".sim"</span><span class="op">)</span><span class="op">)</span>,<span class="st">"naive"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="va">lty</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">method</span>,<span class="st">"mean"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"glmnet"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"transreg.exp.sta"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"transreg.exp.sim"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"transreg.iso.sta"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"transreg.iso.sim"</span><span class="op">=</span><span class="fl">2</span>,<span class="st">"naive"</span><span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>          <span class="va">col</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">method</span>,<span class="st">"mean"</span><span class="op">=</span><span class="st">"grey"</span>,<span class="st">"glmnet"</span><span class="op">=</span><span class="st">"black"</span>,<span class="st">"transreg.exp.sta"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"transreg.iso.sta"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"transreg.exp.sim"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,<span class="st">"transreg.iso.sim"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,<span class="st">"naive"</span><span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span>          <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">table</span><span class="op">[[</span><span class="va">method</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">alpha</span><span class="op">]</span></span>
<span>          <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,col<span class="op">=</span><span class="va">col</span>,lty<span class="op">=</span><span class="va">lty</span><span class="op">)</span><span class="op">}</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,col<span class="op">=</span><span class="st">"white"</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">}</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,col<span class="op">=</span><span class="va">col</span><span class="op">)</span><span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/data/app_int_data.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/results/app_int.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="va">frame</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">frame</span><span class="op">)</span><span class="op">!=</span><span class="st">"seed"</span><span class="op">]</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">cutoff</span><span class="op">)</span></span>
<span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">loss</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">auc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">auc</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">x</span>,INDEX<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">frame</span><span class="op">$</span><span class="va">cutoff</span>,<span class="va">frame</span><span class="op">$</span><span class="va">alpha</span><span class="op">)</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"/manuscript/figure_int.pdf"</span><span class="op">)</span>,width<span class="op">=</span><span class="fl">8</span>,height<span class="op">=</span><span class="fl">6</span>,pointsize<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu">plotter</span><span class="op">(</span><span class="va">table</span>,<span class="va">cutoff</span>,<span class="va">number</span>,horizontal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>Reformat list of consortium members for acknowledgements: [see
source].</p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<p>Print session information.</p>
<table class="table">
<colgroup>
<col width="9%">
<col width="90%">
</colgroup>
<thead><tr class="header">
<th align="left">setting</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">version</td>
<td align="left">R version 4.2.2 (2022-10-31)</td>
</tr>
<tr class="even">
<td align="left">os</td>
<td align="left">macOS Monterey 12.6</td>
</tr>
<tr class="odd">
<td align="left">system</td>
<td align="left">aarch64, darwin20</td>
</tr>
<tr class="even">
<td align="left">ui</td>
<td align="left">X11</td>
</tr>
<tr class="odd">
<td align="left">language</td>
<td align="left">en</td>
</tr>
<tr class="even">
<td align="left">collate</td>
<td align="left">en_US.UTF-8</td>
</tr>
<tr class="odd">
<td align="left">ctype</td>
<td align="left">en_US.UTF-8</td>
</tr>
<tr class="even">
<td align="left">tz</td>
<td align="left">Europe/Luxembourg</td>
</tr>
<tr class="odd">
<td align="left">date</td>
<td align="left">2022-12-01</td>
</tr>
<tr class="even">
<td align="left">pandoc</td>
<td align="left">2.19.2 @
/Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via
rmarkdown)</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">package</th>
<th align="left">loadedversion</th>
<th align="left">date</th>
<th align="left">source</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">bslib</td>
<td align="left">bslib</td>
<td align="left">0.4.0</td>
<td align="left">2022-07-16</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">cachem</td>
<td align="left">cachem</td>
<td align="left">1.0.6</td>
<td align="left">2021-08-19</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">callr</td>
<td align="left">callr</td>
<td align="left">3.7.2</td>
<td align="left">2022-08-22</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">cli</td>
<td align="left">cli</td>
<td align="left">3.4.1</td>
<td align="left">2022-09-23</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">codetools</td>
<td align="left">codetools</td>
<td align="left">0.2-18</td>
<td align="left">2020-11-04</td>
<td align="left">CRAN (R 4.2.2)</td>
</tr>
<tr class="even">
<td align="left">crayon</td>
<td align="left">crayon</td>
<td align="left">1.5.2</td>
<td align="left">2022-09-29</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">desc</td>
<td align="left">desc</td>
<td align="left">1.4.2</td>
<td align="left">2022-09-08</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">devtools</td>
<td align="left">devtools</td>
<td align="left">2.4.5</td>
<td align="left">2022-10-11</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">digest</td>
<td align="left">digest</td>
<td align="left">0.6.30</td>
<td align="left">2022-10-18</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">ellipsis</td>
<td align="left">ellipsis</td>
<td align="left">0.3.2</td>
<td align="left">2021-04-29</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">evaluate</td>
<td align="left">evaluate</td>
<td align="left">0.16</td>
<td align="left">2022-08-09</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">fastmap</td>
<td align="left">fastmap</td>
<td align="left">1.1.0</td>
<td align="left">2021-01-25</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">foreach</td>
<td align="left">foreach</td>
<td align="left">1.5.2</td>
<td align="left">2022-02-02</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">fs</td>
<td align="left">fs</td>
<td align="left">1.5.2</td>
<td align="left">2021-12-08</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">glmnet</td>
<td align="left">glmnet</td>
<td align="left">4.1-4</td>
<td align="left">2022-04-15</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">glue</td>
<td align="left">glue</td>
<td align="left">1.6.2</td>
<td align="left">2022-02-24</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">htmltools</td>
<td align="left">htmltools</td>
<td align="left">0.5.3</td>
<td align="left">2022-07-18</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">htmlwidgets</td>
<td align="left">htmlwidgets</td>
<td align="left">1.5.4</td>
<td align="left">2021-09-08</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">httpuv</td>
<td align="left">httpuv</td>
<td align="left">1.6.6</td>
<td align="left">2022-09-08</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">iterators</td>
<td align="left">iterators</td>
<td align="left">1.0.14</td>
<td align="left">2022-02-05</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">jquerylib</td>
<td align="left">jquerylib</td>
<td align="left">0.1.4</td>
<td align="left">2021-04-26</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">jsonlite</td>
<td align="left">jsonlite</td>
<td align="left">1.8.0</td>
<td align="left">2022-02-22</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">knitr</td>
<td align="left">knitr</td>
<td align="left">1.40</td>
<td align="left">2022-08-24</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">later</td>
<td align="left">later</td>
<td align="left">1.3.0</td>
<td align="left">2021-08-18</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">lattice</td>
<td align="left">lattice</td>
<td align="left">0.20-45</td>
<td align="left">2021-09-22</td>
<td align="left">CRAN (R 4.2.2)</td>
</tr>
<tr class="even">
<td align="left">lifecycle</td>
<td align="left">lifecycle</td>
<td align="left">1.0.3</td>
<td align="left">2022-10-07</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">magrittr</td>
<td align="left">magrittr</td>
<td align="left">2.0.3</td>
<td align="left">2022-03-30</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">Matrix</td>
<td align="left">Matrix</td>
<td align="left">1.5-1</td>
<td align="left">2022-09-13</td>
<td align="left">CRAN (R 4.2.2)</td>
</tr>
<tr class="odd">
<td align="left">memoise</td>
<td align="left">memoise</td>
<td align="left">2.0.1</td>
<td align="left">2021-11-26</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">mime</td>
<td align="left">mime</td>
<td align="left">0.12</td>
<td align="left">2021-09-28</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">miniUI</td>
<td align="left">miniUI</td>
<td align="left">0.1.1.1</td>
<td align="left">2018-05-18</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">palasso</td>
<td align="left">palasso</td>
<td align="left">0.0.8</td>
<td align="left">2021-04-19</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">pkgbuild</td>
<td align="left">pkgbuild</td>
<td align="left">1.3.1</td>
<td align="left">2021-12-20</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">pkgdown</td>
<td align="left">pkgdown</td>
<td align="left">2.0.6</td>
<td align="left">2022-07-16</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">pkgload</td>
<td align="left">pkgload</td>
<td align="left">1.3.0</td>
<td align="left">2022-06-27</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">prettyunits</td>
<td align="left">prettyunits</td>
<td align="left">1.1.1</td>
<td align="left">2020-01-24</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">processx</td>
<td align="left">processx</td>
<td align="left">3.7.0</td>
<td align="left">2022-07-07</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">profvis</td>
<td align="left">profvis</td>
<td align="left">0.3.7</td>
<td align="left">2020-11-02</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">promises</td>
<td align="left">promises</td>
<td align="left">1.2.0.1</td>
<td align="left">2021-02-11</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">ps</td>
<td align="left">ps</td>
<td align="left">1.7.1</td>
<td align="left">2022-06-18</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">purrr</td>
<td align="left">purrr</td>
<td align="left">0.3.4</td>
<td align="left">2020-04-17</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">R6</td>
<td align="left">R6</td>
<td align="left">2.5.1</td>
<td align="left">2021-08-19</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">ragg</td>
<td align="left">ragg</td>
<td align="left">1.2.3</td>
<td align="left">2022-09-29</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">Rcpp</td>
<td align="left">Rcpp</td>
<td align="left">1.0.9</td>
<td align="left">2022-07-08</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">remotes</td>
<td align="left">remotes</td>
<td align="left">2.4.2</td>
<td align="left">2021-11-30</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">rlang</td>
<td align="left">rlang</td>
<td align="left">1.0.6</td>
<td align="left">2022-09-24</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">rmarkdown</td>
<td align="left">rmarkdown</td>
<td align="left">2.16</td>
<td align="left">2022-08-24</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">rprojroot</td>
<td align="left">rprojroot</td>
<td align="left">2.0.3</td>
<td align="left">2022-04-02</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">rstudioapi</td>
<td align="left">rstudioapi</td>
<td align="left">0.14</td>
<td align="left">2022-08-22</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">sass</td>
<td align="left">sass</td>
<td align="left">0.4.2</td>
<td align="left">2022-07-16</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">sessioninfo</td>
<td align="left">sessioninfo</td>
<td align="left">1.2.2</td>
<td align="left">2021-12-06</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">shape</td>
<td align="left">shape</td>
<td align="left">1.4.6</td>
<td align="left">2021-05-19</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">shiny</td>
<td align="left">shiny</td>
<td align="left">1.7.2</td>
<td align="left">2022-07-19</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">starnet</td>
<td align="left">starnet</td>
<td align="left">0.0.6</td>
<td align="left">2020-11-24</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">stringi</td>
<td align="left">stringi</td>
<td align="left">1.7.8</td>
<td align="left">2022-07-11</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">stringr</td>
<td align="left">stringr</td>
<td align="left">1.4.1</td>
<td align="left">2022-08-20</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">survival</td>
<td align="left">survival</td>
<td align="left">3.4-0</td>
<td align="left">2022-08-09</td>
<td align="left">CRAN (R 4.2.2)</td>
</tr>
<tr class="even">
<td align="left">systemfonts</td>
<td align="left">systemfonts</td>
<td align="left">1.0.4</td>
<td align="left">2022-02-11</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">textshaping</td>
<td align="left">textshaping</td>
<td align="left">0.3.6</td>
<td align="left">2021-10-13</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">transreg</td>
<td align="left">transreg</td>
<td align="left">0.99.1</td>
<td align="left">2022-12-01</td>
<td align="left">local</td>
</tr>
<tr class="odd">
<td align="left">urlchecker</td>
<td align="left">urlchecker</td>
<td align="left">1.0.1</td>
<td align="left">2021-11-30</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">usethis</td>
<td align="left">usethis</td>
<td align="left">2.1.6</td>
<td align="left">2022-05-25</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">xfun</td>
<td align="left">xfun</td>
<td align="left">0.33</td>
<td align="left">2022-09-12</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="even">
<td align="left">xtable</td>
<td align="left">xtable</td>
<td align="left">1.8-4</td>
<td align="left">2019-04-21</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
<tr class="odd">
<td align="left">yaml</td>
<td align="left">yaml</td>
<td align="left">2.3.5</td>
<td align="left">2022-02-21</td>
<td align="left">CRAN (R 4.2.0)</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Armin Rauschenberger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
