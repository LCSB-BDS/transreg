% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiridge.R
\name{multiridge}
\alias{multiridge}
\alias{predict.multiridge}
\alias{coef.multiridge}
\title{Multi-penalty ridge regression}
\usage{
multiridge(X, Y, family)

\method{predict}{multiridge}(object, newx, ...)

\method{coef}{multiridge}(object, ...)
}
\arguments{
\item{X}{list of matrices with n rows}

\item{Y}{vector of length n}

\item{family}{character "gaussian" or "binomial"}

\item{object}{multiridge-object}

\item{newx}{list of matrices (new data)}

\item{...}{(not applicable)}
}
\description{
These functions can be used to
cross-validate multi-penalty ridge regression (\code{multiridge}),
extract predicted values (\code{predict.multiridge}),
and extract estimated coefficients (\code{coef.multiridge}).
For full functionality, use the R package \code{\link[multiridge:multiridge-package]{multiridge}}.
}
\examples{
# simulation
n0 <- 100 # training samples
n1 <- 10000 # testing samples
n <- n0 + n1
p1 <- 5 # first covariate set
p2 <- 500 # second covariate set
X1 <- matrix(rnorm(n*p1),nrow=n,ncol=p1)
X2 <- matrix(rnorm(n*p2),nrow=n,ncol=p2)
beta1 <- rep(c(0,10),times=c(p1-4,4))
beta2 <- c(rnorm(100),rep(0,times=p2-100))
eta <- X2 \%*\% beta2 + X1 \%*\% beta1
family <- "binomial" # "gaussian" or "binomial"
if(family=="gaussian"){
 y <- eta
} else if(family=="binomial"){
 y <- round(1/(1+exp(-eta)))
}
fold <- rep(c(0,1),times=c(n0,n1))

# single penalty
glmnet <- glmnet::cv.glmnet(x=cbind(X1[fold==0,],X2[fold==0,]),y=y[fold==0],family=family,alpha=0)
y_hat0 <- predict(glmnet,newx=cbind(X1[fold==1,],X2[fold==1,]),s="lambda.min",type="response")

if("multiridge" \%in\% installed.packages()){
# multiple penalties
object <- multiridge(X=list(X1[fold==0,],X2[fold==0,]),Y=y[fold==0],family=family)
y_hat1 <- predict(object,newx=list(X1[fold==1,],X2[fold==1,]))

# comparison
if(family=="gaussian"){
loss0 <- mean((y[fold==1]-y_hat0)^2)
loss1 <- mean((y[fold==1]-y_hat1)^2)
} else if(family=="binomial"){
loss0 <- mean(y[fold==1]!=round(y_hat0))
loss1 <- mean(y[fold==1]!=round(y_hat1))
}
loss0
loss1

# equivalence
beta <- coef(object)
eta2 <- beta[[1]] + X1[fold==1,] \%*\% beta[[2]] + X2[fold==1,] \%*\% beta[[3]]
if(family=="gaussian"){
y_hat2 <- eta2
} else if(family=="binomial"){
y_hat2 <- 1/(1 + exp(-eta2))
}
all.equal(y_hat1,y_hat2)
}
}
\references{
Mark A. van de Wiel
\href{https://orcid.org/0000-0003-4780-8472}{\figure{orcid_16x16.png}{(iD)}},
Mirrelijn M. van Nee
\href{https://orcid.org/0000-0001-7715-1446}{\figure{orcid_16x16.png}{(iD)}},
and Armin Rauschenberger
\href{https://orcid.org/0000-0001-6498-4801}{\figure{orcid_16x16.png}{(iD)}}
(2021).
"Fast cross-validation for multi-penalty high-dimensional ridge regression".
\emph{Journal of Computational and Graphical Statistics} 30(4):835-847.
\doi{10.1080/10618600.2021.1904962}
}
