% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{transreg}
\alias{transreg}
\title{Penalised regression with multiple sets of prior effects}
\usage{
transreg(
  y,
  X,
  prior,
  family = "gaussian",
  alpha = 1,
  foldid = NULL,
  nfolds = 10,
  scale = "iso",
  stack = "mf",
  sign = FALSE,
  switch = TRUE,
  select = TRUE,
  diffpen = FALSE
)
}
\arguments{
\item{y}{target: vector of length \eqn{n} (see \code{family})}

\item{X}{features: matrix with \eqn{n} rows (samples)
and \eqn{p} columns (features)}

\item{prior}{prior coefficients: matrix with \eqn{p} rows (features)
and \eqn{k} columns (sources of co-data)}

\item{family}{character "gaussian" (\eqn{y}: real numbers),
"binomial" (\eqn{y}: 0s and 1s),
or "poisson" (\eqn{y}: non-negative integers);}

\item{alpha}{elastic net mixing parameter (0=ridge, 1=lasso):
number between 0 and 1}

\item{foldid}{fold identifiers: vector of length \eqn{n}
with entries from 1 to \code{nfolds}}

\item{nfolds}{number of folds: positive integer}

\item{scale}{character
"exp" for exponential calibration or
"iso" for isotonic calibration}

\item{stack}{character
"lp" for linear predictor stacking
of "mf" for meta-feature stacking}

\item{sign}{sign discovery procedure: logical}

\item{switch}{choose between positive and negative weights for each source: logical}

\item{select}{select from sources: logical}

\item{diffpen}{differential penalisation for features and meta-features: logical}
}
\value{
This function returns an object of class \code{transreg}.
Rather than accessing its slots (see below),
it is recommended to use methods like
\code{predict.transreg} and \code{coef.transreg}.
\itemize{
\item slot \code{base}:
Object of class \code{glmnet}.
Regression of outcome on features (without prior effects),
with 1 + p estimated coefficients
(intercept + features).
\item slot \code{meta.lp}:
\code{NULL} or object of class \code{glmnet}.
Regression of outcome on cross-validated linear predictors
from prior effects and estimated effects,
with 1 + k + 2 estimated coefficients
(intercept + sources of co-data + lambda_min and lambda_1se).
*slot \code{meta.mf}:
\code{NULL} or object of class \code{glmnet}.
Regression of outcome on meta-features
(cross-validated linear predictors from prior effects)
and original features,
with 1 + k + p estimated coefficients
(intercept + sources of co-data + features).
\item slot \code{scale}:
indicates the chosen calibration approach
("exp": exponential calibration, "iso": isotonic calibration)
\item slot \code{stack}:
indicates the chosen stacking approach
("lp": linear predictor stacking, "mf": meta-feature stacking)
}
}
\description{
Implements penalised regression with multiple sets of prior effects
}
\details{
\itemize{
\item \eqn{n}: sample size
\item \eqn{p}: number of features
\item \eqn{k}: number of sources
}
}
\examples{
n <- 100; p <- 500
X <- matrix(rnorm(n=n*p),nrow=n,ncol=p)
beta <- rnorm(p)*rbinom(n=p,size=1,prob=0.2)
prior <- beta # plus noise
y <- X \%*\% beta
prior <- ifelse(beta<(-1),0,ifelse(beta>1,beta,0))
plot(x=beta,y=prior)
object <- transreg(y=y,X=X,prior=prior,stack=c("lp","mf"))
dim(coef(object$base))
dim(coef(object$meta.lp))
dim(coef(object$meta.mf))

}
\references{
Armin Rauschenberger
\href{https://orcid.org/0000-0001-6498-4801}{\figure{orcid_16x16.png}},
Zied Landoulsi
\href{https://orcid.org/0000-0002-2327-3904}{\figure{orcid_16x16.png}},
Mark A van de Wiel
\href{https://orcid.org/0000-0003-4780-8472}{\figure{orcid_16x16.png}},
and Enrico Glaab
\href{https://orcid.org/0000-0003-3977-7469}{\figure{orcid_16x16.png}}
(2022).
"Penalised regression with multiple sets of prior effects".
\emph{Manuscript in preparation.}
\email{armin.rauschenberger@uni.lu}
}
\seealso{
Methods for objects of class \code{transreg}
include \code{\link[=coef.transreg]{coef}}
and \code{\link[=predict.transreg]{predict}}.
}
